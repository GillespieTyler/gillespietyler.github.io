<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tetris Game</title>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #333;
            color: white;
            font-family: Arial, sans-serif;
        }
        #tetris {
            display: grid;
            grid-template-rows: repeat(20, 30px);
            grid-template-columns: repeat(10, 30px);
            gap: 1px;
            background-color: #444;
        }
        .cell {
            width: 30px;
            height: 30px;
            background-color: #555;
        }
        .filled {
            background-color: #f0f0f0;
        }
    </style>
</head>
<body>

<div id="tetris"></div>

<script>
    const tetris = document.getElementById('tetris');
    const width = 10;
    const height = 20;
    const cells = [];

    for (let i = 0; i < width * height; i++) {
        const cell = document.createElement('div');
        cell.classList.add('cell');
        tetris.appendChild(cell);
        cells.push(cell);
    }

    const colors = [
        'red', 'blue', 'green', 'purple', 'orange'
    ];

    const tetrominoes = [
        [1, width+1, width*2+1, 2], // L
        [0, width, width+1, width*2+1], // Z
        [1, width, width+1, width+2], // T
        [0, 1, width, width+1], // O
        [1, width+1, width*2+1, width*3+1] // I
    ];

    let currentPosition = 4;
    let currentRotation = 0;
    let random = Math.floor(Math.random() * tetrominoes.length);
    let current = tetrominoes[random];

    function draw() {
        current.forEach(index => {
            cells[currentPosition + index].classList.add('filled');
            cells[currentPosition + index].style.backgroundColor = colors[random];
        });
    }

    function undraw() {
        current.forEach(index => {
            cells[currentPosition + index].classList.remove('filled');
            cells[currentPosition + index].style.backgroundColor = '';
        });
    }

    function moveDown() {
        undraw();
        currentPosition += width;
        draw();
        freeze();
    }

    function freeze() {
        if (current.some(index => cells[currentPosition + index + width].classList.contains('filled'))) {
            current.forEach(index => cells[currentPosition + index].classList.add('taken'));
            random = Math.floor(Math.random() * tetrominoes.length);
            current = tetrominoes[random];
            currentPosition = 4;
            draw();
        }
    }

    function moveLeft() {
        undraw();
        const isAtLeftEdge = current.some(index => (currentPosition + index) % width === 0);
        if (!isAtLeftEdge) currentPosition -= 1;
        if (current.some(index => cells[currentPosition + index].classList.contains('taken'))) {
            currentPosition += 1;
        }
        draw();
    }

    function moveRight() {
        undraw();
        const isAtRightEdge = current.some(index => (currentPosition + index) % width === width - 1);
        if (!isAtRightEdge) currentPosition += 1;
        if (current.some(index => cells[currentPosition + index].classList.contains('taken'))) {
            currentPosition -= 1;
        }
        draw();
    }

    function rotate() {
        undraw();
        currentRotation++;
        if (currentRotation === current.length) {
            currentRotation = 0;
        }
        current = tetrominoes[random][currentRotation];
        draw();
    }

    document.addEventListener('keydown', control);

    function control(e) {
        if (e.keyCode === 37) {
            moveLeft();
        } else if (e.keyCode === 38) {
            rotate();
        } else if (e.keyCode === 39) {
            moveRight();
        } else if (e.keyCode === 40) {
            moveDown();
        }
    }

    draw();
    setInterval(moveDown, 1000);
</script>

</body>
</html>
